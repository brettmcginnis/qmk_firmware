// ⌘⌥^
// ⌘: /, O
// ⌘ Shift: A, O, Left, Right)
// ⌘ ⌥: L
// ^ ⌥: O
// ⌥: enter
// ⌥ shift:

// https://notgate.github.io/layout/
// https://github.com/callum-oakley/qmk_firmware/tree/master/users/callum
// https://docs.qmk.fm/#/keycodes

// word = otherWord(
//  \n
// )

#include QMK_KEYBOARD_H

enum preonic_layers {
  _IRST,
  _LOWER,
  _RAISE,
  _ADJUST
};

enum preonic_keycodes {
  IRST = SAFE_RANGE,
  LOWER,
  RAISE,
  ADJUST
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
// when, is, fun companion, object, inline, val, init, run, also, apply, with, null, false, true, private, override, on
// Ctrl < Option < Command < Shift
/* ISRT
  * ,-----------------------------------------------------------------------------------.
  * |   Y  |   C  |   L  |   M  |   K  |  __  |  __  |   Z  |   F  |   U  |  '"  | Bksp |
  * |------+------+------+------+------+------+------+------+------+------+------+------|
  * |  I ^ | S ⌥  | R  ⌘ |  T ⇧ |   G  |  __  |  __  |   P  |  N ⇧ |  E	⌘ |  A ⌥ | O ^  |
  * |------+------+------+------+------+-------------+------+------+------+------+------|
  * |   Q  |   V  |   W  |   D  |   J  |  __  |  __  |   B  |   H  |  /?  |   .  |   X  |
  * |------+------+------+------+------+------|------+------+------+------+------+------|
  * |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |
  * |------+------+------+------+------+------+------+------+------+------+------+------|
  * |  __  |  __  |  __  |ToNav |      |             |Space |RAISE |  __  |  __  |  __  |
  * `-----------------------------------------------------------------------------------'
  */
[0] = LAYOUT_preonic_grid(
  KC_Y, KC_C, KC_L, KC_M, KC_K, _______, _______, KC_Z, KC_F, KC_U, KC_QUOT, KC_BSPC,
  LCTL_T(KC_I), LOPT_T(KC_S), LCMD_T(KC_R), LSFT_T(KC_T), KC_G, _______, _______, KC_P, RSFT_T(KC_N), RCMD_T(KC_E), ROPT_T(KC_A), RCTL_T(KC_O),
  KC_Q, KC_V, KC_W, KC_D, KC_J, _______, _______, KC_B, KC_H, KC_SLSH, KC_DOT, KC_X,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______, _______, LOWER, KC_LSFT, _______, _______, KC_SPC, RAISE, _______, _______, _______
),

/* Navigation
  * ,-----------------------------------------------------------------------------------.
  * |  Tab |      |      |      |      |  __  |  __  |      | Home |  Up  | End  | Bksp |
  * |------+------+------+------+------+------+------+------+------+------+------+------|
  * |Esc ^ |   ⌥  |    ⌘ |    ⇧ |      |  __  |  __  |      | Left | Down |Right | Enter|
  * |------+------+------+------+------+-------------+------+------+------+------+------|
  * |      |      |      |      |      |  __  |  __  |      |PageUp|      |PageDo|      |
  * |------+------+------+------+------+------|------+------+------+------+------+------|
  * |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |
  * |------+------+------+------+------+------+------+------+------+------+------+------|
  * |  __  |  __  |  __  |      |Shift |             |Space |toISRT|  __  |  __  |  __  |
  * `-----------------------------------------------------------------------------------'
  */
[_LOWER] = LAYOUT_preonic_grid(
  KC_TAB, _______, _______, _______, _______, _______, _______, _______, KC_HOME, KC_UP, KC_END, KC_BSPC,
  // 
  KC_ESC, _______, _______, _______, _______, _______, _______, _______, KC_LEFT, KC_DOWN, KC_RIGHT, KC_ENTER,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______
),

// TODO: 
// (	27 (14.2%)
// 2. )	27 (14.2%)
// 3. .	23 (12.1%)
// 4. =	23 (12.1%)
// 5. ,	18 (9.5%)
// 6. {	16 (8.4%)
// 7. }	16 (8.4%)
// 8. "	12 (6.3%)
// 9. >	9 (4.7%)
// 10. <

// From code: = {} () . _ , ? : -> || && !, :: @ " ~ ` < ' * * $ ;
// All: `-=~!@#$%^&*()_+[]{}\|;:'",.<>/?
// Pairs
// `~
// 

// `~
// 32 / 10 + (11 x 2)
// 192.168.2.xxx
// ?:
// ^⌥⌘⇧ 
/* Numbers / Symbol
  * ,-----------------------------------------------------------------------------------.
  * |  Tab |  \|  |  =+  |  {}  |      |  __  |  __  |      |  1!  |  2@  |  3#  | Bksp |
  * |------+------+------+------+------+------+------+------+------+------+------+------|
  * |ESC ^ | ,< ⌥ | .> ⌘ |  ()⇧ |      |  __  |  __  |  0   |  4$⌘ |  5%⌥ |  6^^ | Enter|
  * |------+------+------+------+------+-------------+------+------+------+------+------|
  * |      |      |  -_  |  []  |      |  __  |  __  |      |  7&  |  8*  |  9   |  ;:  |
  * |------+------+------+------+------+------|------+------+------+------+------+------|
  * |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |
  * |------+------+------+------+------+------+------+------+------+------+------+------|
  * |  __  |  __  |  __  |      |Shift |             |Space |      |  __  |  __  |  __  |
  * `-----------------------------------------------------------------------------------'
  */
[_RAISE] = LAYOUT_preonic_grid(
  KC_U, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, KC_BSPC,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______
),

/* Media / Function
  * ,-----------------------------------------------------------------------------------.
  * |   x  |   ⏮ |   ️⏯ |   ⏭  |      |  __  |  __  | fn1  | fn2  | fn3  | fn4  | Bksp |
  * |------+------+------+------+------+------+------+------+------+------+------+------|
  * |   ^  |   ⌥  |   ⌘  |   ⇧  |      |  __  |  __  | fin5 |fn6 ⌘ |fn7 ⌥ |fn8 ^ | Enter|
  * |------+------+------+------+------+-------------+------+------+------+------+------|
  * |Reset |Debug |      |      |      |  __  |  __  | fn9  | fn10 | fn11 | fn12 |      |
  * |------+------+------+------+------+------|------+------+------+------+------+------|
  * |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |  __  |
  * |------+------+------+------+------+------+------+------+------+------+------+------|
  * |  __  |  __  |  __  |      |Shift |             |Space |      |  __  |  __  |  __  |
  * `-----------------------------------------------------------------------------------'
 */
[3] = LAYOUT_preonic_grid(
  KC_X, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  RESET,   DEBUG, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______,_______, _______, _______, _______, _______, _______, _______, _______, _______, _______,
  _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______
)
};

// TODO Set ISRT to default
// Raise / lower switch layers
// Both Raise / Lower = one shot
// set_single_persistent_default_layer(_ISRT);

bool process_record_user(uint16_t keycode, keyrecord_t *record) {
  switch (keycode) {
    case LOWER:
      if (record->event.pressed) {
        layer_on(_LOWER);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      } else {
        layer_off(_LOWER);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      }
      return false;
    case RAISE:
      if (record->event.pressed) {
        layer_on(_RAISE);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      } else {
        layer_off(_RAISE);
        update_tri_layer(_LOWER, _RAISE, _ADJUST);
      }
      return false;
    }
  return true;
}
